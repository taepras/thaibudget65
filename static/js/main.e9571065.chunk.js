(this.webpackJsonpthaibudget65=this.webpackJsonpthaibudget65||[]).push([[0],{145:function(t,e,n){},149:function(t,e,n){},154:function(t,e,n){"use strict";n.r(e);var i,r=n(0),o=n.n(r),l=n(48),a=n.n(l),c=(n(145),n(23)),s=n(25),u=n(33),d=n(12),v=n(9),f=n(3),j=n(24),h=(n.p,n(149),n(54)),b=n(49),g=n(50),x=n(32).a.div(i||(i=Object(g.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  flex-direction: column;\n"]))),O=n(1);var p=function(t){var e=t.data,n=void 0===e?[]:e,i=t.isLoading,o=void 0===i||i,l=t.padding,a=void 0===l?16:l,c=t.filters,u=void 0===c?["all"]:c,g=(t.setFilters,t.hierarchyBy),p=void 0===g?[]:g,y=Object(b.a)({onResize:function(t){var e=t.observe,n=t.unobserve;t.w,t.h,t.entr;n(),e()}}),m=y.observe,T=(y.unobserve,y.width),I=y.height,w=(y.entry,Object(f.d)()),E=Object(r.useRef)(null),R=Object(r.useState)("treemap"),k=Object(d.a)(R,2),S=k[0],U=(k[1],Object(r.useMemo)((function(){console.log("filters",u);var t=Object(h.a)(),e=function(e){t=t.key((function(t){return t[p[e]]}))};for(var i in u)e(i);var r={key:"root",values:[{key:"all",values:t.rollup((function(t){return v.f(t,(function(t){return t.AMOUNT}))})).entries(n)}]},o=function(t){var e,n,i;r=null===(e=r)||void 0===e||null===(n=e.values)||void 0===n||null===(i=n.filter)||void 0===i?void 0:i.call(n,(function(e){return e.key===u[t]}))[0]};for(var l in u)o(l);return console.log("indata",r),r}),[n,u,p]));return Object(r.useEffect)((function(){if(E.current){console.log("nested",U);var t=E.current.clientHeight;console.log(t);var e=v.b(U,(function(t){return null===t||void 0===t?void 0:t.values})).sum((function(t){return null===t||void 0===t?void 0:t.value})).sort((function(t,e){return(null===e||void 0===e?void 0:e.value)-(null===t||void 0===t?void 0:t.value)})),n=(v.g().size([T-2*a,t-2*a]).padding(3)(e),v.e(E.current).select("g.chart")),i=(v.d().domain([0,v.c(e.leaves(),(function(t){return t.value}))]).range([0,T-2*a]),n.selectAll("g.treemap-piece").data(e.leaves(),(function(t){var e;return null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.key}))),r=i.enter().append("g").attr("class","treemap-piece").attr("data-tip",(function(t){var e,n,i;return"".concat(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.key,"<br>").concat(null===t||void 0===t||null===(n=t.value)||void 0===n||null===(i=n.toLocaleString)||void 0===i?void 0:i.call(n)," \u0e1a\u0e32\u0e17")}));r.append("rect"),r.append("text").attr("class","text-name").attr("font-size","12px").attr("fill","white"),r.append("text").attr("class","text-value").attr("font-size","12px").attr("fill","white");var o=r.merge(i);"treemap"===S&&(o.on("click",null).on("click",(function(t,e){var n=e.x0,i=e.y0,r=(T-2*a)/(e.x1-e.x0),l=(I-2*a)/(e.y1-e.y0);o.transition().duration(300).attr("transform",(function(t){return"translate(".concat((t.x0-n)*r,",").concat((t.y0-i)*l,")")})),o.select("rect").transition().duration(300).attr("width",(function(t){return r*(t.x1-t.x0)})).attr("height",(function(t){return l*(t.y1-t.y0)})),setTimeout((function(){var t,n=[].concat(Object(s.a)(u),[null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.key]);n.length<=p.length&&w.push("/".concat(n.join("/")))}),300)})).attr("transform",(function(t){return"translate(".concat(t.x0,",").concat(t.y0,")")})).transition().duration(600).attr("opacity",1).attr("data-tip",(function(t){var e,n,i;return"".concat(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.key,"<br>").concat(null===t||void 0===t||null===(n=t.value)||void 0===n||null===(i=n.toLocaleString)||void 0===i?void 0:i.call(n)," \u0e1a\u0e32\u0e17")})),o.select("rect").attr("rx",2).style("fill","DarkSlateBlue").attr("width",(function(t){return t.x1-t.x0})).attr("height",(function(t){return t.y1-t.y0})),o.select("text.text-name").attr("x",5).attr("y",8).attr("dominant-baseline","hanging").text((function(t){var e;return null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.key})),o.select("text.text-value").attr("x",5).attr("y",24).attr("fill-opacity",.7).attr("dominant-baseline","hanging").attr("opacity",1).text((function(t){return"".concat(t.value.toLocaleString()," \u0e1a\u0e32\u0e17")}))),i.exit().transition().delay(300).duration(600).attr("opacity",0).delay(300).remove(),j.a.rebuild(),console.log("rebuilding tooltip"),console.log("too small",e.leaves().filter((function(t){return(t.x1-t.x0)*(t.y1-t.y0)<100}))),console.log("too narrow",e.leaves().filter((function(t){return t.x1-t.x0<20}))),console.log("too short",e.leaves().filter((function(t){return t.y1-t.y0<20})))}}),[E,U,u,T,I,S,a,w,p]),Object(O.jsxs)("div",{ref:m,style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",flexDirection:"column",overflowY:"auto"},children:[o&&Object(O.jsx)(x,{style:{backgroundColor:"#000c",alignItems:"center",justifyContent:"center"},children:"Loading..."}),Object(O.jsx)("div",{style:{height:a,marginBottom:-a,background:"linear-gradient(#000f, #0000)",width:"100%",zIndex:1,pointerEvents:"none"}}),Object(O.jsx)("svg",{ref:E,width:T,height:I,children:Object(O.jsx)("g",{transform:"translate(".concat(a,", ").concat(a,")"),className:"chart"})}),Object(O.jsx)("div",{style:{height:a,marginTop:-a,background:"linear-gradient(#0000, #000f)",width:"100%",zIndex:1,pointerEvents:"none"}})]})},y=["MINISTRY","BUDGETARY_UNIT","BUDGET_PLAN","OUTPUT_PROJECT","ITEM"],m={MINISTRY:"\u0e01\u0e23\u0e30\u0e17\u0e23\u0e27\u0e07\u0e2b\u0e23\u0e37\u0e2d\u0e40\u0e17\u0e35\u0e22\u0e1a\u0e40\u0e17\u0e48\u0e32",BUDGETARY_UNIT:"\u0e2b\u0e19\u0e48\u0e27\u0e22\u0e23\u0e31\u0e1a\u0e07\u0e1a\u0e2f",BUDGET_PLAN:"\u0e41\u0e1c\u0e19\u0e07\u0e32\u0e19",OUTPUT_PROJECT:"\u0e1c\u0e25\u0e1c\u0e25\u0e34\u0e15/\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23",ITEM:"\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23"};var T=function(){var t=Object(r.useState)([]),e=Object(d.a)(t,2),n=e[0],i=e[1],o=Object(r.useState)(!0),l=Object(d.a)(o,2),a=l[0],c=l[1],h=Object(r.useState)(""),b=Object(d.a)(h,2),g=b[0],T=b[1],I=Object(r.useState)(!1),w=Object(d.a)(I,2),E=w[0],R=(w[1],Object(r.useState)(["all"])),k=Object(d.a)(R,2),S=k[0],U=k[1];Object(r.useEffect)((function(){v.a("".concat("/thaibudget65","/data.csv")).then((function(t){c(!1),i(t)}))}),[]);var C=Object(r.useMemo)((function(){return n.map((function(t){return Object(u.a)(Object(u.a)({},t),{},{AMOUNT:parseFloat(t.AMOUNT.replace(/,/g,"")),OUTPUT_PROJECT:t.OUTPUT||t.PROJECT?t.OUTPUT+t.PROJECT:"\u0e44\u0e21\u0e48\u0e23\u0e30\u0e1a\u0e38\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23/\u0e1c\u0e25\u0e1c\u0e25\u0e34\u0e15",MINISTRY:t.MINISTRY.replace(/\([0-9]+\)$/,"").trim(),ITEM:[t.ITEM_DESCRIPTION,t.CATEGORY_LV2,t.CATEGORY_LV3,t.CATEGORY_LV4,t.CATEGORY_LV5,t.CATEGORY_LV6].filter((function(t){return t})).join(" - ")})})).filter((function(t){return 2022===+t.FISCAL_YEAR})).filter((function(t){return function(t,e){var n=["MINISTRY","BUDGETARY_UNIT"];for(var i in n)if(t[n[i]].includes(e))return!0;return!1}(t,g)}))}),[n,g]),L=Object(f.e)(),A=Object(f.d)();return Object(r.useEffect)((function(){var t=L.pathname.split("/").slice(1);console.log("f",t,t.length>0&&t[0]?t:["all"]),U(t.length>0&&t[0]?t:["all"])}),[L]),Object(O.jsxs)(x,{children:[Object(O.jsxs)("div",{style:{height:60,display:"flex",alignItems:"center",paddingLeft:16,paddingRight:16,overflowX:"auto"},children:[Object(O.jsx)("div",{style:{flexGrow:1,display:"flex",alignItems:"center"},children:S.map((function(t,e){return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("button",{type:"button",onClick:function(){return function(t,e){console.log(t,e);var n=Object(s.a)(S);n.splice(e+1),console.log("temp",n),A.push("/".concat(n.join("/")))}(t,e)},style:{marginRight:4,backgroundColor:"transparent",border:"none",color:"white"},children:[Object(O.jsx)("small",{style:{opacity:"0.4"},children:e>0&&m[y[e-1]]}),e>0&&Object(O.jsx)("br",{}),Object(O.jsx)("span",{style:{textDecoration:e<S.length-1?"underline":"none"},children:0===e?""===g?"\u0e2b\u0e19\u0e48\u0e27\u0e22\u0e07\u0e32\u0e19\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14":'\u0e2b\u0e19\u0e48\u0e27\u0e22\u0e07\u0e32\u0e19\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14\u0e17\u0e35\u0e48\u0e0a\u0e37\u0e48\u0e2d\u0e21\u0e35\u0e04\u0e33\u0e27\u0e48\u0e32 "'.concat(g,'"'):t})]}),e===S.length-1&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("small",{style:{color:"white",marginRight:8,opacity:"0.4"},children:":"}),Object(O.jsxs)("small",{style:{color:"white",marginRight:4,opacity:"0.4"},children:["\u0e41\u0e1a\u0e48\u0e07\u0e15\u0e32\u0e21"," ",m[y[e]]]})]}),e<S.length-1&&Object(O.jsx)("span",{style:{color:"white",marginRight:4},children:">"})]})}))}),Object(O.jsxs)("div",{children:[Object(O.jsx)("label",{children:"Filter: "}),Object(O.jsx)("input",{value:g,onInput:function(t){return T(t.target.value)},placeholder:"\u0e2b\u0e19\u0e48\u0e27\u0e22\u0e23\u0e31\u0e1a\u0e07\u0e1a\u0e2b\u0e23\u0e37\u0e2d\u0e01\u0e23\u0e30\u0e17\u0e23\u0e27\u0e07"})]})]}),Object(O.jsxs)("div",{style:{display:"flex",flexDirection:"row",flexGrow:1},children:[Object(O.jsx)("div",{style:{position:"relative",flexGrow:1},children:Object(O.jsx)(p,{data:C,isLoading:a,filters:S,hierarchyBy:y,setFilters:U})}),E&&Object(O.jsx)("div",{style:{position:"relative",flexGrow:1},children:Object(O.jsx)(p,{data:C,isLoading:a,filters:S,hierarchyBy:y,setFilters:U})})]}),Object(O.jsxs)("div",{style:{padding:16,paddingTop:8,fontSize:12,opacity:"0.7",display:"flex"},children:[Object(O.jsxs)("div",{style:{position:"relative",flexGrow:1},children:["**Work-In-Progress**",Object(O.jsx)("br",{}),"\u0e42\u0e04\u0e23\u0e07\u0e2a\u0e23\u0e49\u0e32\u0e07\u0e07\u0e1a\u0e1b\u0e23\u0e30\u0e21\u0e32\u0e13\u0e1b\u0e35 65"]}),Object(O.jsxs)("div",{style:{textAlign:"right"},children:["Visualization by"," ",Object(O.jsx)("a",{href:"https://taepras.com",style:{color:"white"},children:"Thanawit Prasongpongchai"}),Object(O.jsx)("br",{}),"Data Source:"," ",Object(O.jsx)("a",{href:"https://docs.google.com/spreadsheets/d/1yyWXSTbq3CD_gNxks-krcSBzbszv3c_2Nq54lckoQ24/edit#gid=343539850",style:{color:"white"},children:"\u0e01\u0e25\u0e38\u0e48\u0e21\u0e01\u0e49\u0e32\u0e27 Geek"})]})]}),Object(O.jsx)(j.a,{multiline:!0})]})},I=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,157)).then((function(e){var n=e.getCLS,i=e.getFID,r=e.getFCP,o=e.getLCP,l=e.getTTFB;n(t),i(t),r(t),o(t),l(t)}))};a.a.render(Object(O.jsx)(o.a.StrictMode,{children:Object(O.jsx)(c.a,{children:Object(O.jsx)(T,{})})}),document.getElementById("root")),I()}},[[154,1,2]]]);
//# sourceMappingURL=main.e9571065.chunk.js.map