{"version":3,"sources":["logo.svg","components/FullView.jsx","components/Treemap.jsx","components/DataView.jsx","App.jsx","reportWebVitals.js","index.jsx"],"names":["FullView","styled","div","Treemap","data","isLoading","padding","gutter","filters","setFilters","hierarchyBy","setCurrentSum","sum","fullValue","index","isMultipleMaxSum","sumWindows","useDimensions","onResize","observe","unobserve","w","h","entr","width","height","svgRef","entry","useRef","useState","setSum","displayMode","nestedData","useMemo","console","log","out","nest","i","key","d","inData","values","rollup","leaves","d3","l","AMOUNT","entries","filter","useEffect","s","reduce","a","b","value","current","svgHeight","clientHeight","root","sort","newSum","newSumWin","idx0","indexOf","fullVal","treeFullArea","treeAspect","treeCurrentArea","treeH","Math","sqrt","treeW","svg","size","treemap","select","treemapPieceGroup","domain","range","selectAll","treemapPieceGroupEnter","enter","append","attr","replaceAll","style","toLocaleString","x0","y0","x1","y1","treemapPieceMerged","merge","on","e","el","newSumWindows","idx","newFullValue","newArea","newH","newW","dx","dy","sx","sy","classed","transition","duration","p","max","setTimeout","newFilters","length","text","exit","delay","remove","ReactTooltip","rebuild","position","top","left","right","bottom","display","flexDirection","overflowY","paddingLeft","fontSize","marginBottom","zIndex","whiteSpace","opacity","backgroundColor","alignItems","justifyContent","background","pointerEvents","flexGrow","ref","transform","className","marginTop","THAI_NAME","MINISTRY","BUDGETARY_UNIT","BUDGET_PLAN","OUTPUT_PROJECT","ITEM","DataView","searchQuery","setSearchQuery","filterDataByQuery","useCallback","datum","query","searchLevels","includes","filteredData","location","useLocation","useHistory","f","pathname","split","slice","paddingRight","overflowX","map","x","type","onClick","temp","splice","navigateTo","marginRight","border","color","textAlign","textDecoration","substr","onChange","target","placeholder","HiddenMobile","App","setData","setLoading","isCompareView","setCompareView","setSumWindows","process","then","setSumWindowsIdx","maxSumValue","mx","preprocessedData","parseFloat","replace","OUTPUT","PROJECT","trim","ITEM_DESCRIPTION","CATEGORY_LV2","CATEGORY_LV3","CATEGORY_LV4","CATEGORY_LV5","CATEGORY_LV6","join","FISCAL_YEAR","paddingTop","paddingBottom","borderRadius","href","multiline","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.c4ecf7f5.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo.6ce24c58.svg\";","import React from 'react';\nimport styled from 'styled-components';\n\nconst FullView = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  flex-direction: column;\n`;\n\nexport default FullView;\n","import React, {\n  useEffect, useMemo, useRef, useState,\n} from 'react';\n\nimport * as d3 from 'd3';\nimport { nest } from 'd3-collection';\nimport useDimensions from 'react-cool-dimensions';\nimport ReactTooltip from 'react-tooltip';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport FullView from './FullView';\n\nconst THAI_NAME = {\n  MINISTRY: 'กระทรวงหรือเทียบเท่า',\n  BUDGETARY_UNIT: 'หน่วยรับงบฯ',\n  BUDGET_PLAN: 'แผนงาน',\n  OUTPUT_PROJECT: 'ผลผลิต/โครงการ',\n  ITEM: 'รายการ',\n};\n\nfunction Treemap({\n  data = [],\n  isLoading = true,\n  padding = 16,\n  gutter = 4,\n  filters = ['all'],\n  setFilters = () => { },\n  hierarchyBy = [],\n  setCurrentSum = (sum) => { },\n  fullValue = -1,\n  index = 0,\n  isMultipleMaxSum = false,\n  sumWindows = [],\n}) {\n  const {\n    observe, unobserve, width, height, entry,\n  } = useDimensions({\n    onResize: ({\n      /* eslint-disable-next-line no-shadow */\n      observe, unobserve, w, h, entr,\n    }) => {\n      unobserve();\n      observe();\n    },\n  });\n\n  // const history = useHistory();\n\n  const svgRef = useRef(null);\n\n  // const [data, setData] = useState([]);\n  const [sum, setSum] = useState(-1); // or 'bar'\n  const [displayMode, setDisplayMode] = useState('treemap'); // or 'bar'\n\n  const nestedData = useMemo(() => {\n    console.log('filters', filters);\n\n    let out = nest();\n    // eslint-disable-next-line guard-for-in, no-restricted-syntax\n    for (const i in filters) {\n      // for (const i in hierarchyBy) {\n      // console.log(hierarchyBy[i], filters[i])\n      out = out.key((d) => d[hierarchyBy[i]]);\n    }\n\n    const nested = out\n      .rollup((leaves) => d3.sum(leaves, (l) => l.AMOUNT))\n      .entries(data);\n\n    let inData = {\n      key: 'root',\n      values: [{ key: 'all', values: nested }],\n    };\n\n    // eslint-disable-next-line guard-for-in, no-restricted-syntax\n    for (const i in filters) {\n      inData = inData?.values?.filter?.((d) => d.key === filters[i])[0];\n    }\n\n    console.log('indata', inData);\n\n    return inData;\n  }, [data, filters, hierarchyBy]);\n\n  useEffect(() => {\n    const s = nestedData.values.reduce((a, b) => a + b.value, 0);\n    console.log('sum', s);\n    if (sum !== s) { setCurrentSum(s); }\n    setSum(s);\n  }, [nestedData, setCurrentSum, sum]);\n\n  useEffect(() => {\n    if (!svgRef.current) return;\n\n    console.log('fullVal', fullValue);\n    console.log('nested', nestedData);\n    const svgHeight = svgRef.current.clientHeight;\n    console.log(svgHeight);\n\n    const root = d3.hierarchy(nestedData, (d) => d?.values)\n      .sum((d) => d?.value)\n      .sort((a, b) => b?.value - a?.value);\n\n    const newSum = nestedData.values.reduce((a, b) => a + b.value, 0);\n\n    const newSumWin = [...sumWindows];\n    const idx0 = newSumWin.indexOf(sum);\n    if (idx0 !== -1) {\n      newSumWin[idx0] = newSum;\n    }\n    const fullVal = d3.max(newSumWin);\n    const treeFullArea = (width - 2 * padding) * (svgHeight - 2 * padding);\n    const treeAspect = (width - 2 * padding) / (svgHeight - 2 * padding);\n    const treeCurrentArea = (newSum / (fullVal || 1)) * treeFullArea;\n    console.log('sumw', index, sumWindows, newSumWin, sum, fullVal, newSum);\n    const treeH = fullVal <= 0 ? svgHeight - 2 * padding : Math.sqrt(treeCurrentArea / treeAspect);\n    const treeW = fullVal <= 0 ? width - 2 * padding : treeCurrentArea / treeH;\n\n    const treemap = d3.treemap()\n      .size([treeW, treeH])\n      .padding(0);\n      // .round(true);\n\n    const nodes = treemap(root);\n\n    const svg = d3.select(svgRef.current).select('g.chart');\n\n    const barScale = d3.scaleLinear()\n      .domain([0, d3.max(root.leaves(), (d) => d.value)])\n      .range([0, width - 2 * padding]);\n\n    const treemapPieceGroup = svg\n      .selectAll('g.treemap-piece')\n      .data(root.leaves(), (d) => d?.data?.key);\n\n    const treemapPieceGroupEnter = treemapPieceGroup\n      .enter()\n      .append('g')\n      .attr('class', 'treemap-piece')\n      .attr('id', (d) => `${d?.data?.key.replaceAll(/[ ()]/g, '')}-${index}`)\n      .style('mask', (d) => `url(#mask-${d?.data?.key.replaceAll(/[ ()]/g, '')}-${index})`)\n      .attr('data-tip', (d) => `${d?.data?.key}<br>${d?.value?.toLocaleString?.()} บาท`)\n      .attr('transform', (d) => `translate(${d.x0 || 0},${d.y0 || 0})`);\n    // .attr('opacity', 0);\n\n    treemapPieceGroupEnter\n      .append('rect')\n      .attr('class', 'box')\n      .attr('rx', 3)\n      .style('fill', 'DarkSlateBlue')\n      .attr('width', (d) => (d.x1 - d.x0) || 0)\n      .attr('height', (d) => (d.y1 - d.y0) || 0);\n    // .attr('x', d => d.x0)\n    // .attr('y', d => d.y0)\n    // .style('stroke', 'black')\n\n    // .style('fill', 'cyan');\n\n    treemapPieceGroupEnter\n      .append('mask')\n      .attr('id', (d) => `mask-${d?.data?.key.replaceAll(/[ ()]/g, '')}-${index}`)\n      .append('rect')\n      .attr('class', 'mask')\n      .attr('rx', 3)\n      .style('fill', 'white')\n      .attr('width', (d) => (d.x1 - d.x0) || 0)\n      .attr('height', (d) => (d.y1 - d.y0) || 0);\n\n    treemapPieceGroupEnter\n      .append('text')\n      .attr('class', 'text-name')\n      .attr('font-size', '12px')\n      .attr('fill', 'white');\n\n    treemapPieceGroupEnter\n      .append('text')\n      .attr('class', 'text-value')\n      .attr('font-size', '12px')\n      .attr('fill', 'white');\n\n    const treemapPieceMerged = treemapPieceGroupEnter.merge(treemapPieceGroup);\n\n    treemapPieceMerged\n      .on('click', null)\n      .on('click', (e, d, el) => {\n        // const treeFullArea = (width - 2 * padding) * (svgHeight - 2 * padding);\n        // const treeAspect = (width - 2 * padding) / (svgHeight - 2 * padding);\n        // const treeCurrentArea = (sum / (fullValue || 1)) * treeFullArea;\n        const newSumWindows = [...sumWindows];\n        const idx = newSumWindows.indexOf(sum);\n        if (idx !== -1) {\n          newSumWindows[idx] = d.value;\n        }\n        const newFullValue = d3.max(newSumWindows);\n\n        // const newFullValue = sum === fullValue && !isMultipleMaxSum ? d.value : fullValue;\n        // const newArea = (d.value / (fullValue || 1)) * treeFullArea;\n        const newArea = (d.value / (newFullValue || 1)) * treeFullArea;\n        const newH = Math.sqrt(newArea / treeAspect);\n        const newW = newArea / newH;\n\n        const dx = d.x0;\n        const dy = d.y0;\n        const sx = newW / (d.x1 - d.x0);\n        const sy = newH / (d.y1 - d.y0);\n\n        console.log('prp', d3.select(this), e, d, el);\n        // const sx = 0.43;\n        // const sy = 1.05;\n\n        d3.select(this).classed('selected', true);\n\n        treemapPieceMerged\n          .transition()\n          .duration(300)\n          .attr('transform', (p) => `translate(${(p.x0 - dx) * sx},${(p.y0 - dy) * sy})`);\n\n        treemapPieceMerged.select('rect.box')\n          .transition()\n          .duration(300)\n          .attr('width', (p) => Math.max(sx * (p.x1 - p.x0), 0))\n          .attr('height', (p) => Math.max(sy * (p.y1 - p.y0), 0));\n\n        treemapPieceMerged.select('rect.mask')\n          .transition()\n          .duration(300)\n          .attr('width', (p) => Math.max(sx * (p.x1 - p.x0), 0))\n          .attr('height', (p) => Math.max(sy * (p.y1 - p.y0), 0));\n\n        setTimeout(() => {\n          const newFilters = [...filters, d?.data?.key];\n          if (newFilters.length <= hierarchyBy.length) {\n            setFilters(newFilters);\n            // history.push(`/${newFilters.join('/')}`);\n          }\n        }, 300);\n      })\n      .transition()\n      .duration(300)\n      .attr('transform', (d) => `translate(${d.x0},${d.y0})`)\n      .attr('opacity', 1)\n      .attr('data-tip', (d) => `${d?.data?.key}<br>${d?.value?.toLocaleString?.()} บาท`);\n\n    treemapPieceMerged.select('rect.box')\n      .transition()\n      .duration(300)\n      .attr('rx', 3)\n      .attr('fill', 'DarkSlateBlue')\n      .attr('stroke', 'black')\n      .attr('stroke-width', gutter)\n      .attr('width', (d) => Math.max((d.x1 - d.x0) || 0, 0))\n      .attr('height', (d) => Math.max((d.y1 - d.y0) || 0, 0));\n\n    treemapPieceMerged.select('rect.mask')\n      .transition()\n      .duration(300)\n      .attr('rx', 3)\n      .style('fill', 'white')\n      .attr('width', (d) => Math.max((d.x1 - d.x0) || 0, 0))\n      .attr('height', (d) => Math.max((d.y1 - d.y0) || 0, 0));\n\n    treemapPieceMerged.select('text.text-name')\n      .attr('x', 5)\n      .attr('y', 8)\n      .attr('dominant-baseline', 'hanging')\n      .text((d) => d?.data?.key);\n\n    treemapPieceMerged.select('text.text-value')\n      .attr('x', 5)\n      .attr('y', 24)\n      .attr('fill-opacity', 0.7)\n      .attr('dominant-baseline', 'hanging')\n      .attr('opacity', 1)\n      .text((d) => `${d.value.toLocaleString()} บาท`);\n\n    treemapPieceGroup.exit()\n      .transition()\n      .delay(150)\n      .duration(600)\n      .attr('opacity', 0)\n      // .delay(300)\n      .remove();\n\n    ReactTooltip.rebuild();\n    console.log('rebuilding tooltip');\n\n    console.log('too small', root.leaves().filter((d) => (d.x1 - d.x0) * (d.y1 - d.y0) < 100));\n    console.log('too narrow', root.leaves().filter((d) => d.x1 - d.x0 < 20));\n    console.log('too short', root.leaves().filter((d) => d.y1 - d.y0 < 20));\n  }, [\n    svgRef,\n    nestedData,\n    filters,\n    width,\n    height,\n    displayMode,\n    padding,\n    gutter,\n    hierarchyBy,\n    setFilters,\n    fullValue,\n    sum,\n    index,\n    isMultipleMaxSum,\n    sumWindows,\n  ]);\n\n  return (\n    <div\n      style={{\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        display: 'flex',\n        flexDirection: 'column',\n        overflowY: 'auto',\n      }}\n    >\n      <div style={{\n        paddingLeft: 18,\n        fontSize: 12,\n        marginBottom: -padding + 4,\n        zIndex: 2,\n      }}\n      >\n        <b style={{ whiteSpace: 'nowrap' }}>{filters[filters.length - 1] === 'all' ? 'รวมทุกหน่วยงาน' : filters[filters.length - 1]}</b>\n        <br />\n        <span style={{ opacity: 0.7 }}>\n          {sum.toLocaleString()}\n          {' '}\n          บาท\n        </span>\n      </div>\n      {isLoading\n        && (\n        <FullView\n          style={{\n            backgroundColor: '#000c',\n            alignItems: 'center',\n            justifyContent: 'center',\n          }}\n        >\n          Loading...\n        </FullView>\n        )}\n\n      <div\n        style={{\n          height: padding,\n          marginBottom: -padding,\n          background: 'linear-gradient(#000f, #0000)',\n          width: '100%',\n          zIndex: 1,\n          pointerEvents: 'none',\n        }}\n      />\n      <div style={{ flexGrow: 1, position: 'relative' }}>\n        <div\n          style={{\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            right: 0,\n            bottom: 0,\n            display: 'flex',\n            flexDirection: 'column',\n            overflowY: 'auto',\n          }}\n          ref={observe}\n        >\n          <svg ref={svgRef} width={width} height={height}>\n            <g transform={`translate(${padding}, ${padding})`} className=\"chart\" />\n          </svg>\n        </div>\n      </div>\n      <div\n        style={{\n          height: padding,\n          marginTop: -padding,\n          background: 'linear-gradient(#0000, #000f)',\n          width: '100%',\n          zIndex: 1,\n          pointerEvents: 'none',\n        }}\n      />\n    </div>\n  );\n}\n\nexport default Treemap;\n","import React, {\n  useCallback, useEffect, useMemo, useState,\n} from 'react';\nimport * as d3 from 'd3';\nimport styled from 'styled-components';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport ReactTooltip from 'react-tooltip';\nimport Treemap from './Treemap';\nimport FullView from './FullView';\n\nconst TOP_BAR_HEIGHT = 60;\n\nconst hierarchyBy = [\n  'MINISTRY',\n  'BUDGETARY_UNIT',\n  'BUDGET_PLAN',\n  // 'OUPUT',\n  // 'PROJECT',\n  'OUTPUT_PROJECT',\n  // 'CATEGORY_LV1',\n  'ITEM',\n  // 'CATEGORY_LV2',\n  // 'CATEGORY_LV3',\n  // 'CATEGORY_LV4',\n  // 'CATEGORY_LV5',\n  // 'CATEGORY_LV6',\n  // 'ITEM_DESCRIPTION',\n];\n\nconst THAI_NAME = {\n  MINISTRY: 'กระทรวงหรือเทียบเท่า',\n  BUDGETARY_UNIT: 'หน่วยรับงบฯ',\n  BUDGET_PLAN: 'แผนงาน',\n  OUTPUT_PROJECT: 'ผลผลิต/โครงการ',\n  ITEM: 'รายการ',\n};\n\nfunction DataView({\n  data,\n  isLoading,\n  setCurrentSum = (sum) => { },\n  fullValue = -1,\n  index = 0,\n  isMultipleMaxSum = false,\n  sumWindows = [],\n}) {\n  const [searchQuery, setSearchQuery] = useState('');\n  const [filters, setFilters] = useState(['all']);\n\n  const filterDataByQuery = useCallback((datum, query) => {\n    const searchLevels = [\n      'MINISTRY',\n      'BUDGETARY_UNIT',\n    ];\n    // eslint-disable-next-line guard-for-in, no-restricted-syntax\n    for (const i in searchLevels) {\n      if (datum[searchLevels[i]].includes(query)) { return true; }\n    }\n    return false;\n  }, []);\n\n  const filteredData = useMemo(\n    () => data.filter((d) => filterDataByQuery(d, searchQuery)),\n    [data, filterDataByQuery, searchQuery],\n  );\n\n  const location = useLocation();\n  const history = useHistory();\n\n  useEffect(() => {\n    const f = location.pathname.split('/').slice(1);\n    console.log('f', f, f.length > 0 && f[0] ? f : ['all']);\n    setFilters(f.length > 0 && f[0] ? f : ['all']);\n  }, [location]);\n\n  const navigateTo = (x, i) => {\n    console.log(x, i);\n    const temp = [...filters];\n    temp.splice(i + 1);\n    // setFilters(temp);\n    console.log('temp', temp);\n    setFilters(temp);\n    // history.push(`/${temp.join('/')}`);\n  };\n\n  return (\n    <FullView>\n      {/*\n      <button type=\"button\" onClick={() => setCompareView(!isCompareView)}>\n      toggle compare view\n      </button>\n       */}\n      <div\n        style={{\n          height: TOP_BAR_HEIGHT,\n          display: 'flex',\n          alignItems: 'center',\n          paddingLeft: 16,\n          paddingRight: 16,\n          marginBottom: 8,\n        }}\n      >\n        <div\n          style={{\n            flexGrow: 1,\n            display: 'flex',\n            alignItems: 'center',\n            overflowX: 'auto',\n          }}\n        >\n          {/* <button type=\"button\" onClick={() => setDisplayMode('treemap')}>treemap</button>\n        <button type=\"button\" onClick={() => setDisplayMode('bar')}>bar</button> */}\n\n          {filters.map((x, i) => (\n            <>\n              <button\n                type=\"button\"\n                onClick={() => navigateTo(x, i)}\n                style={{\n                  marginRight: 8,\n                  backgroundColor: 'transparent',\n                  border: 'none',\n                  color: 'white',\n                  padding: 0,\n                  textAlign: 'left',\n                }}\n              >\n                <small style={{ opacity: '0.4', whiteSpace: 'nowrap' }}>{i > 0 && THAI_NAME[hierarchyBy[i - 1]]}</small>\n                {i > 0 && <br />}\n                <span style={{ textDecoration: i < filters.length - 1 ? 'underline' : 'none', whiteSpace: 'nowrap' }}>\n                  {i === 0\n                    ? (\n                      searchQuery === ''\n                        ? 'หน่วยงานทั้งหมด'\n                        : `หน่วยงานทั้งหมดที่ชื่อมีคำว่า \"${searchQuery}\"`\n                    )\n                    : x.length < 20 ? x : `${x.substr(0, 20)}...`}\n                </span>\n              </button>\n              {i === filters.length - 1\n                && (\n                  <>\n                    <small style={{ color: 'white', marginRight: 8, opacity: '0.4' }}>\n                      :\n                    </small>\n                    <small style={{ color: 'white', marginRight: 8, opacity: '0.4' }}>\n                      แบ่งตาม\n                      {' '}\n                      {THAI_NAME[hierarchyBy[i]]}\n                    </small>\n                  </>\n                )}\n              {i < filters.length - 1\n                && <span style={{ color: 'white', marginRight: 8 }}>&gt;</span>}\n            </>\n          ))}\n          {/* {JSON.stringify(filters)} */}\n        </div>\n        <div>\n          <label style={{ fontSize: 12, opacity: 0.7 }}>Filter</label>\n          <br />\n          <input\n            type=\"text\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            placeholder=\"หน่วยรับงบหรือกระทรวง\"\n          />\n        </div>\n      </div>\n      <div style={{ display: 'flex', flexDirection: 'row', flexGrow: 1 }}>\n        <div style={{\n          position: 'relative',\n          flexGrow: 1,\n        }}\n        >\n          <Treemap\n            data={filteredData}\n            isLoading={isLoading}\n            filters={filters}\n            hierarchyBy={hierarchyBy}\n            setFilters={setFilters}\n            setCurrentSum={(x) => {\n              // console.log('!!setting sum', x, setCurrentSum);\n              setCurrentSum(x);\n            }}\n            fullValue={fullValue}\n            index={index}\n            isMultipleMaxSum={isMultipleMaxSum}\n            sumWindows={sumWindows}\n          />\n        </div>\n      </div>\n    </FullView>\n  );\n}\n\nexport default DataView;\n","import React, {\n  useCallback, useEffect, useMemo, useState,\n} from 'react';\nimport * as d3 from 'd3';\nimport styled from 'styled-components';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport ReactTooltip from 'react-tooltip';\nimport logo from './logo.svg';\nimport './App.css';\nimport DataView from './components/DataView';\nimport FullView from './components/FullView';\n\nconst HiddenMobile = styled.div`\n  @media (max-width: 480px){\n    display: none !important;\n  }\n`;\n\nfunction App() {\n  const [data, setData] = useState([]);\n  const [isLoading, setLoading] = useState(true);\n  const [isCompareView, setCompareView] = useState(false);\n  const [filters, setFilters] = useState(['all']);\n  const [sumWindows, setSumWindows] = useState([0, 0]);\n\n  useEffect(() => {\n    d3.csv(`${process.env.PUBLIC_URL}/data.csv`).then((d) => {\n      setLoading(false);\n      setData(d);\n    });\n  }, []);\n\n  const setSumWindowsIdx = (i, value) => {\n    const temp = [...sumWindows];\n    temp[i] = value;\n    setSumWindows(temp);\n  };\n\n  const maxSumValue = useMemo(() => d3.max(sumWindows), [sumWindows]);\n\n  const isMultipleMaxSum = useMemo(() => {\n    const mx = d3.max(sumWindows);\n    return sumWindows.filter((x) => mx === x).length > 1;\n  }, [sumWindows]);\n\n  const preprocessedData = useMemo(() => data\n    .map((d) => ({\n      ...d,\n      AMOUNT: parseFloat(d.AMOUNT.replace(/,/g, '')),\n      OUTPUT_PROJECT: (d.OUTPUT || d.PROJECT) ? (d.OUTPUT + d.PROJECT) : 'ไม่ระบุโครงการ/ผลผลิต',\n      MINISTRY: d.MINISTRY.replace(/\\([0-9]+\\)$/, '').trim(),\n      ITEM: [\n        d.ITEM_DESCRIPTION,\n        d.CATEGORY_LV2,\n        d.CATEGORY_LV3,\n        d.CATEGORY_LV4,\n        d.CATEGORY_LV5,\n        d.CATEGORY_LV6,\n      ]\n        .filter((x) => x)\n        .join(' - '),\n    }))\n    .filter((d) => +d.FISCAL_YEAR === 2022),\n  [data]);\n\n  const location = useLocation();\n  const history = useHistory();\n\n  useEffect(() => {\n    const f = location.pathname.split('/').slice(1);\n    console.log('f', f, f.length > 0 && f[0] ? f : ['all']);\n    setFilters(f.length > 0 && f[0] ? f : ['all']);\n  }, [location]);\n\n  const navigateTo = (x, i) => {\n    console.log(x, i);\n    const temp = [...filters];\n    temp.splice(i + 1);\n    // setFilters(temp);\n    console.log('temp', temp);\n    history.push(`/${temp.join('/')}`);\n  };\n\n  return (\n    <FullView>\n      <div style={{ display: 'flex', flexDirection: 'row', flexGrow: 1 }}>\n        <div style={{\n          position: 'relative',\n          flexGrow: 1,\n        }}\n        >\n          <DataView\n            data={preprocessedData}\n            isLoading={isLoading}\n            fullValue={maxSumValue}\n            setCurrentSum={(s) => {\n              console.log('setCurrentSum 0', s);\n              setSumWindowsIdx(0, s);\n            }}\n            isMultipleMaxSum={isMultipleMaxSum}\n            sumWindows={sumWindows}\n            index={0}\n          />\n        </div>\n        {isCompareView && (\n          <div style={{\n            position: 'relative',\n            flexGrow: 1,\n          }}\n          >\n            <DataView\n              data={preprocessedData}\n              isLoading={isLoading}\n              fullValue={maxSumValue}\n              setCurrentSum={(s) => {\n                console.log('setCurrentSum 1', s);\n                setSumWindowsIdx(1, s);\n              }}\n              isMultipleMaxSum={isMultipleMaxSum}\n              sumWindows={sumWindows}\n              index={1}\n            />\n          </div>\n        )}\n        <HiddenMobile style={{\n          position: 'relative',\n          width: 80,\n          padding: 16,\n          display: 'flex',\n          flexDirection: 'column',\n        }}\n        >\n          <button\n            type=\"button\"\n            onClick={() => {\n              if (isCompareView) { setSumWindowsIdx(1, 0); }\n              setCompareView(!isCompareView);\n            }}\n            style={{\n              paddingTop: 16,\n              paddingBottom: 16,\n              backgroundColor: '#181818',\n              border: 'none',\n              color: '#888',\n              borderRadius: 8,\n            }}\n          >\n            <span style={{\n              display: 'inline-flex',\n              fontSize: 24,\n              width: 32,\n              height: 32,\n              borderRadius: '50%',\n              backgroundColor: '#333',\n              color: 'white',\n              alignItems: 'center',\n              justifyContent: 'center',\n              marginBottom: 8,\n            }}\n            >\n              {!isCompareView ? '+' : '×'}\n            </span>\n            <br />\n            {!isCompareView ? 'Open\\nCompare\\nView' : 'Close\\nCompare\\nView'}\n          </button>\n        </HiddenMobile>\n      </div>\n      <div\n        style={{\n          padding: 16,\n          paddingTop: 8,\n          fontSize: 12,\n          opacity: '0.7',\n          display: 'flex',\n        }}\n      >\n        <div\n          style={{\n            position: 'relative',\n            flexGrow: 1,\n          }}\n        >\n          **Work-In-Progress**\n          <br />\n          โครงสร้างงบประมาณปี 65\n        </div>\n        <div style={{ textAlign: 'right' }}>\n          Visualization by\n          {' '}\n          <a href=\"https://taepras.com\" style={{ color: 'white' }}>Thanawit Prasongpongchai</a>\n          <br />\n          Data Source:\n          {' '}\n          <a href=\"https://docs.google.com/spreadsheets/d/1yyWXSTbq3CD_gNxks-krcSBzbszv3c_2Nq54lckoQ24/edit#gid=343539850\" style={{ color: 'white' }}>กลุ่มก้าว Geek</a>\n        </div>\n      </div>\n      <ReactTooltip multiline />\n    </FullView>\n  );\n}\n\nexport default App;\n","const reportWebVitals = (onPerfEntry) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({\n      getCLS, getFID, getFCP, getLCP, getTTFB,\n    }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport {\n  HashRouter as Router,\n  Switch,\n  useLocation,\n} from 'react-router-dom';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Router>\n      <App />\n    </Router>\n  </React.StrictMode>,\n  // eslint-disable-next-line no-undef\n  document.getElementById('root'),\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}