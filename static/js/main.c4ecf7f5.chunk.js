(this.webpackJsonpthaibudget65=this.webpackJsonpthaibudget65||[]).push([[0],{145:function(t,e,n){},149:function(t,e,n){},154:function(t,e,n){"use strict";n.r(e);var i,r=n(0),o=n.n(r),a=n(49),l=n.n(a),c=(n(145),n(19)),s=n(34),u=n(11),d=n(8),f=n(27),v=n(5),h=n(21),j=n(3),b=n(20),x=(n.p,n(149),n(54)),g=n(50),p=h.a.div(i||(i=Object(f.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  flex-direction: column;\n"]))),O=n(1);var y=function(t){var e=this,n=t.data,i=void 0===n?[]:n,o=t.isLoading,a=void 0===o||o,l=t.padding,c=void 0===l?16:l,s=t.gutter,f=void 0===s?4:s,h=t.filters,j=void 0===h?["all"]:h,y=t.setFilters,m=void 0===y?function(){}:y,w=t.hierarchyBy,T=void 0===w?[]:w,S=t.setCurrentSum,k=void 0===S?function(t){}:S,M=t.fullValue,C=void 0===M?-1:M,I=t.index,E=void 0===I?0:I,R=t.isMultipleMaxSum,L=void 0!==R&&R,A=t.sumWindows,U=void 0===A?[]:A,G=Object(g.a)({onResize:function(t){var e=t.observe,n=t.unobserve;t.w,t.h,t.entr;n(),e()}}),B=G.observe,D=(G.unobserve,G.width),N=G.height,P=(G.entry,Object(r.useRef)(null)),_=Object(r.useState)(-1),Y=Object(d.a)(_,2),z=Y[0],V=Y[1],F=Object(r.useState)("treemap"),J=Object(d.a)(F,2),W=J[0],q=(J[1],Object(r.useMemo)((function(){console.log("filters",j);var t=Object(x.a)(),e=function(e){t=t.key((function(t){return t[T[e]]}))};for(var n in j)e(n);var r={key:"root",values:[{key:"all",values:t.rollup((function(t){return v.f(t,(function(t){return t.AMOUNT}))})).entries(i)}]},o=function(t){var e,n,i;r=null===(e=r)||void 0===e||null===(n=e.values)||void 0===n||null===(i=n.filter)||void 0===i?void 0:i.call(n,(function(e){return e.key===j[t]}))[0]};for(var a in j)o(a);return console.log("indata",r),r}),[i,j,T]));return Object(r.useEffect)((function(){var t=q.values.reduce((function(t,e){return t+e.value}),0);console.log("sum",t),z!==t&&k(t),V(t)}),[q,k,z]),Object(r.useEffect)((function(){if(P.current){console.log("fullVal",C),console.log("nested",q);var t=P.current.clientHeight;console.log(t);var n=v.b(q,(function(t){return null===t||void 0===t?void 0:t.values})).sum((function(t){return null===t||void 0===t?void 0:t.value})).sort((function(t,e){return(null===e||void 0===e?void 0:e.value)-(null===t||void 0===t?void 0:t.value)})),i=q.values.reduce((function(t,e){return t+e.value}),0),r=Object(u.a)(U),o=r.indexOf(z);-1!==o&&(r[o]=i);var a=v.c(r),l=(D-2*c)*(t-2*c),s=(D-2*c)/(t-2*c),d=i/(a||1)*l;console.log("sumw",E,U,r,z,a,i);var h=a<=0?t-2*c:Math.sqrt(d/s),x=a<=0?D-2*c:d/h,g=(v.g().size([x,h]).padding(0)(n),v.e(P.current).select("g.chart")),p=(v.d().domain([0,v.c(n.leaves(),(function(t){return t.value}))]).range([0,D-2*c]),g.selectAll("g.treemap-piece").data(n.leaves(),(function(t){var e;return null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.key}))),O=p.enter().append("g").attr("class","treemap-piece").attr("id",(function(t){var e;return"".concat(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.key.replaceAll(/[ ()]/g,""),"-").concat(E)})).style("mask",(function(t){var e;return"url(#mask-".concat(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.key.replaceAll(/[ ()]/g,""),"-").concat(E,")")})).attr("data-tip",(function(t){var e,n,i;return"".concat(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.key,"<br>").concat(null===t||void 0===t||null===(n=t.value)||void 0===n||null===(i=n.toLocaleString)||void 0===i?void 0:i.call(n)," \u0e1a\u0e32\u0e17")})).attr("transform",(function(t){return"translate(".concat(t.x0||0,",").concat(t.y0||0,")")}));O.append("rect").attr("class","box").attr("rx",3).style("fill","DarkSlateBlue").attr("width",(function(t){return t.x1-t.x0||0})).attr("height",(function(t){return t.y1-t.y0||0})),O.append("mask").attr("id",(function(t){var e;return"mask-".concat(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.key.replaceAll(/[ ()]/g,""),"-").concat(E)})).append("rect").attr("class","mask").attr("rx",3).style("fill","white").attr("width",(function(t){return t.x1-t.x0||0})).attr("height",(function(t){return t.y1-t.y0||0})),O.append("text").attr("class","text-name").attr("font-size","12px").attr("fill","white"),O.append("text").attr("class","text-value").attr("font-size","12px").attr("fill","white");var y=O.merge(p);y.on("click",null).on("click",(function(t,n,i){var r=Object(u.a)(U),o=r.indexOf(z);-1!==o&&(r[o]=n.value);var a=v.c(r),c=n.value/(a||1)*l,d=Math.sqrt(c/s),f=c/d,h=n.x0,b=n.y0,x=f/(n.x1-n.x0),g=d/(n.y1-n.y0);console.log("prp",v.e(e),t,n,i),v.e(e).classed("selected",!0),y.transition().duration(300).attr("transform",(function(t){return"translate(".concat((t.x0-h)*x,",").concat((t.y0-b)*g,")")})),y.select("rect.box").transition().duration(300).attr("width",(function(t){return Math.max(x*(t.x1-t.x0),0)})).attr("height",(function(t){return Math.max(g*(t.y1-t.y0),0)})),y.select("rect.mask").transition().duration(300).attr("width",(function(t){return Math.max(x*(t.x1-t.x0),0)})).attr("height",(function(t){return Math.max(g*(t.y1-t.y0),0)})),setTimeout((function(){var t,e=[].concat(Object(u.a)(j),[null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.key]);e.length<=T.length&&m(e)}),300)})).transition().duration(300).attr("transform",(function(t){return"translate(".concat(t.x0,",").concat(t.y0,")")})).attr("opacity",1).attr("data-tip",(function(t){var e,n,i;return"".concat(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.key,"<br>").concat(null===t||void 0===t||null===(n=t.value)||void 0===n||null===(i=n.toLocaleString)||void 0===i?void 0:i.call(n)," \u0e1a\u0e32\u0e17")})),y.select("rect.box").transition().duration(300).attr("rx",3).attr("fill","DarkSlateBlue").attr("stroke","black").attr("stroke-width",f).attr("width",(function(t){return Math.max(t.x1-t.x0||0,0)})).attr("height",(function(t){return Math.max(t.y1-t.y0||0,0)})),y.select("rect.mask").transition().duration(300).attr("rx",3).style("fill","white").attr("width",(function(t){return Math.max(t.x1-t.x0||0,0)})).attr("height",(function(t){return Math.max(t.y1-t.y0||0,0)})),y.select("text.text-name").attr("x",5).attr("y",8).attr("dominant-baseline","hanging").text((function(t){var e;return null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.key})),y.select("text.text-value").attr("x",5).attr("y",24).attr("fill-opacity",.7).attr("dominant-baseline","hanging").attr("opacity",1).text((function(t){return"".concat(t.value.toLocaleString()," \u0e1a\u0e32\u0e17")})),p.exit().transition().delay(150).duration(600).attr("opacity",0).remove(),b.a.rebuild(),console.log("rebuilding tooltip"),console.log("too small",n.leaves().filter((function(t){return(t.x1-t.x0)*(t.y1-t.y0)<100}))),console.log("too narrow",n.leaves().filter((function(t){return t.x1-t.x0<20}))),console.log("too short",n.leaves().filter((function(t){return t.y1-t.y0<20})))}}),[P,q,j,D,N,W,c,f,T,m,C,z,E,L,U]),Object(O.jsxs)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",flexDirection:"column",overflowY:"auto"},children:[Object(O.jsxs)("div",{style:{paddingLeft:18,fontSize:12,marginBottom:4-c,zIndex:2},children:[Object(O.jsx)("b",{style:{whiteSpace:"nowrap"},children:"all"===j[j.length-1]?"\u0e23\u0e27\u0e21\u0e17\u0e38\u0e01\u0e2b\u0e19\u0e48\u0e27\u0e22\u0e07\u0e32\u0e19":j[j.length-1]}),Object(O.jsx)("br",{}),Object(O.jsxs)("span",{style:{opacity:.7},children:[z.toLocaleString()," ","\u0e1a\u0e32\u0e17"]})]}),a&&Object(O.jsx)(p,{style:{backgroundColor:"#000c",alignItems:"center",justifyContent:"center"},children:"Loading..."}),Object(O.jsx)("div",{style:{height:c,marginBottom:-c,background:"linear-gradient(#000f, #0000)",width:"100%",zIndex:1,pointerEvents:"none"}}),Object(O.jsx)("div",{style:{flexGrow:1,position:"relative"},children:Object(O.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",flexDirection:"column",overflowY:"auto"},ref:B,children:Object(O.jsx)("svg",{ref:P,width:D,height:N,children:Object(O.jsx)("g",{transform:"translate(".concat(c,", ").concat(c,")"),className:"chart"})})})}),Object(O.jsx)("div",{style:{height:c,marginTop:-c,background:"linear-gradient(#0000, #000f)",width:"100%",zIndex:1,pointerEvents:"none"}})]})},m=["MINISTRY","BUDGETARY_UNIT","BUDGET_PLAN","OUTPUT_PROJECT","ITEM"],w={MINISTRY:"\u0e01\u0e23\u0e30\u0e17\u0e23\u0e27\u0e07\u0e2b\u0e23\u0e37\u0e2d\u0e40\u0e17\u0e35\u0e22\u0e1a\u0e40\u0e17\u0e48\u0e32",BUDGETARY_UNIT:"\u0e2b\u0e19\u0e48\u0e27\u0e22\u0e23\u0e31\u0e1a\u0e07\u0e1a\u0e2f",BUDGET_PLAN:"\u0e41\u0e1c\u0e19\u0e07\u0e32\u0e19",OUTPUT_PROJECT:"\u0e1c\u0e25\u0e1c\u0e25\u0e34\u0e15/\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23",ITEM:"\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23"};var T,S=function(t){var e=t.data,n=t.isLoading,i=t.setCurrentSum,o=void 0===i?function(t){}:i,a=t.fullValue,l=void 0===a?-1:a,c=t.index,s=void 0===c?0:c,f=t.isMultipleMaxSum,v=void 0!==f&&f,h=t.sumWindows,b=void 0===h?[]:h,x=Object(r.useState)(""),g=Object(d.a)(x,2),T=g[0],S=g[1],k=Object(r.useState)(["all"]),M=Object(d.a)(k,2),C=M[0],I=M[1],E=Object(r.useCallback)((function(t,e){var n=["MINISTRY","BUDGETARY_UNIT"];for(var i in n)if(t[n[i]].includes(e))return!0;return!1}),[]),R=Object(r.useMemo)((function(){return e.filter((function(t){return E(t,T)}))}),[e,E,T]),L=Object(j.e)();return Object(j.d)(),Object(r.useEffect)((function(){var t=L.pathname.split("/").slice(1);console.log("f",t,t.length>0&&t[0]?t:["all"]),I(t.length>0&&t[0]?t:["all"])}),[L]),Object(O.jsxs)(p,{children:[Object(O.jsxs)("div",{style:{height:60,display:"flex",alignItems:"center",paddingLeft:16,paddingRight:16,marginBottom:8},children:[Object(O.jsx)("div",{style:{flexGrow:1,display:"flex",alignItems:"center",overflowX:"auto"},children:C.map((function(t,e){return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("button",{type:"button",onClick:function(){return function(t,e){console.log(t,e);var n=Object(u.a)(C);n.splice(e+1),console.log("temp",n),I(n)}(t,e)},style:{marginRight:8,backgroundColor:"transparent",border:"none",color:"white",padding:0,textAlign:"left"},children:[Object(O.jsx)("small",{style:{opacity:"0.4",whiteSpace:"nowrap"},children:e>0&&w[m[e-1]]}),e>0&&Object(O.jsx)("br",{}),Object(O.jsx)("span",{style:{textDecoration:e<C.length-1?"underline":"none",whiteSpace:"nowrap"},children:0===e?""===T?"\u0e2b\u0e19\u0e48\u0e27\u0e22\u0e07\u0e32\u0e19\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14":'\u0e2b\u0e19\u0e48\u0e27\u0e22\u0e07\u0e32\u0e19\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14\u0e17\u0e35\u0e48\u0e0a\u0e37\u0e48\u0e2d\u0e21\u0e35\u0e04\u0e33\u0e27\u0e48\u0e32 "'.concat(T,'"'):t.length<20?t:"".concat(t.substr(0,20),"...")})]}),e===C.length-1&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("small",{style:{color:"white",marginRight:8,opacity:"0.4"},children:":"}),Object(O.jsxs)("small",{style:{color:"white",marginRight:8,opacity:"0.4"},children:["\u0e41\u0e1a\u0e48\u0e07\u0e15\u0e32\u0e21"," ",w[m[e]]]})]}),e<C.length-1&&Object(O.jsx)("span",{style:{color:"white",marginRight:8},children:">"})]})}))}),Object(O.jsxs)("div",{children:[Object(O.jsx)("label",{style:{fontSize:12,opacity:.7},children:"Filter"}),Object(O.jsx)("br",{}),Object(O.jsx)("input",{type:"text",value:T,onChange:function(t){return S(t.target.value)},placeholder:"\u0e2b\u0e19\u0e48\u0e27\u0e22\u0e23\u0e31\u0e1a\u0e07\u0e1a\u0e2b\u0e23\u0e37\u0e2d\u0e01\u0e23\u0e30\u0e17\u0e23\u0e27\u0e07"})]})]}),Object(O.jsx)("div",{style:{display:"flex",flexDirection:"row",flexGrow:1},children:Object(O.jsx)("div",{style:{position:"relative",flexGrow:1},children:Object(O.jsx)(y,{data:R,isLoading:n,filters:C,hierarchyBy:m,setFilters:I,setCurrentSum:function(t){o(t)},fullValue:l,index:s,isMultipleMaxSum:v,sumWindows:b})})})]})},k=h.a.div(T||(T=Object(f.a)(["\n  @media (max-width: 480px){\n    display: none !important;\n  }\n"])));var M=function(){var t=Object(r.useState)([]),e=Object(d.a)(t,2),n=e[0],i=e[1],o=Object(r.useState)(!0),a=Object(d.a)(o,2),l=a[0],c=a[1],f=Object(r.useState)(!1),h=Object(d.a)(f,2),x=h[0],g=h[1],y=Object(r.useState)(["all"]),m=Object(d.a)(y,2),w=(m[0],m[1]),T=Object(r.useState)([0,0]),M=Object(d.a)(T,2),C=M[0],I=M[1];Object(r.useEffect)((function(){v.a("".concat("/thaibudget65","/data.csv")).then((function(t){c(!1),i(t)}))}),[]);var E=function(t,e){var n=Object(u.a)(C);n[t]=e,I(n)},R=Object(r.useMemo)((function(){return v.c(C)}),[C]),L=Object(r.useMemo)((function(){var t=v.c(C);return C.filter((function(e){return t===e})).length>1}),[C]),A=Object(r.useMemo)((function(){return n.map((function(t){return Object(s.a)(Object(s.a)({},t),{},{AMOUNT:parseFloat(t.AMOUNT.replace(/,/g,"")),OUTPUT_PROJECT:t.OUTPUT||t.PROJECT?t.OUTPUT+t.PROJECT:"\u0e44\u0e21\u0e48\u0e23\u0e30\u0e1a\u0e38\u0e42\u0e04\u0e23\u0e07\u0e01\u0e32\u0e23/\u0e1c\u0e25\u0e1c\u0e25\u0e34\u0e15",MINISTRY:t.MINISTRY.replace(/\([0-9]+\)$/,"").trim(),ITEM:[t.ITEM_DESCRIPTION,t.CATEGORY_LV2,t.CATEGORY_LV3,t.CATEGORY_LV4,t.CATEGORY_LV5,t.CATEGORY_LV6].filter((function(t){return t})).join(" - ")})})).filter((function(t){return 2022===+t.FISCAL_YEAR}))}),[n]),U=Object(j.e)();return Object(j.d)(),Object(r.useEffect)((function(){var t=U.pathname.split("/").slice(1);console.log("f",t,t.length>0&&t[0]?t:["all"]),w(t.length>0&&t[0]?t:["all"])}),[U]),Object(O.jsxs)(p,{children:[Object(O.jsxs)("div",{style:{display:"flex",flexDirection:"row",flexGrow:1},children:[Object(O.jsx)("div",{style:{position:"relative",flexGrow:1},children:Object(O.jsx)(S,{data:A,isLoading:l,fullValue:R,setCurrentSum:function(t){console.log("setCurrentSum 0",t),E(0,t)},isMultipleMaxSum:L,sumWindows:C,index:0})}),x&&Object(O.jsx)("div",{style:{position:"relative",flexGrow:1},children:Object(O.jsx)(S,{data:A,isLoading:l,fullValue:R,setCurrentSum:function(t){console.log("setCurrentSum 1",t),E(1,t)},isMultipleMaxSum:L,sumWindows:C,index:1})}),Object(O.jsx)(k,{style:{position:"relative",width:80,padding:16,display:"flex",flexDirection:"column"},children:Object(O.jsxs)("button",{type:"button",onClick:function(){x&&E(1,0),g(!x)},style:{paddingTop:16,paddingBottom:16,backgroundColor:"#181818",border:"none",color:"#888",borderRadius:8},children:[Object(O.jsx)("span",{style:{display:"inline-flex",fontSize:24,width:32,height:32,borderRadius:"50%",backgroundColor:"#333",color:"white",alignItems:"center",justifyContent:"center",marginBottom:8},children:x?"\xd7":"+"}),Object(O.jsx)("br",{}),x?"Close\nCompare\nView":"Open\nCompare\nView"]})})]}),Object(O.jsxs)("div",{style:{padding:16,paddingTop:8,fontSize:12,opacity:"0.7",display:"flex"},children:[Object(O.jsxs)("div",{style:{position:"relative",flexGrow:1},children:["**Work-In-Progress**",Object(O.jsx)("br",{}),"\u0e42\u0e04\u0e23\u0e07\u0e2a\u0e23\u0e49\u0e32\u0e07\u0e07\u0e1a\u0e1b\u0e23\u0e30\u0e21\u0e32\u0e13\u0e1b\u0e35 65"]}),Object(O.jsxs)("div",{style:{textAlign:"right"},children:["Visualization by"," ",Object(O.jsx)("a",{href:"https://taepras.com",style:{color:"white"},children:"Thanawit Prasongpongchai"}),Object(O.jsx)("br",{}),"Data Source:"," ",Object(O.jsx)("a",{href:"https://docs.google.com/spreadsheets/d/1yyWXSTbq3CD_gNxks-krcSBzbszv3c_2Nq54lckoQ24/edit#gid=343539850",style:{color:"white"},children:"\u0e01\u0e25\u0e38\u0e48\u0e21\u0e01\u0e49\u0e32\u0e27 Geek"})]})]}),Object(O.jsx)(b.a,{multiline:!0})]})},C=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,157)).then((function(e){var n=e.getCLS,i=e.getFID,r=e.getFCP,o=e.getLCP,a=e.getTTFB;n(t),i(t),r(t),o(t),a(t)}))};l.a.render(Object(O.jsx)(o.a.StrictMode,{children:Object(O.jsx)(c.a,{children:Object(O.jsx)(M,{})})}),document.getElementById("root")),C()}},[[154,1,2]]]);
//# sourceMappingURL=main.c4ecf7f5.chunk.js.map